@model AllMCPSolution.Models.InventoryAddModalViewModel?
@using System
@using System.Collections.Generic
@using Microsoft.AspNetCore.Html
@using AllMCPSolution.Models
@{
    var locationOptions = Model?.Locations ?? Array.Empty<BottleLocationOption>();
    string BuildLocationLabel(BottleLocationOption option)
    {
        var name = string.IsNullOrWhiteSpace(option.Name) ? option.Id.ToString() : option.Name;
        return option.Capacity.HasValue ? $"{name} ({option.Capacity.Value} capacity)" : name;
    }
    var modal = new WineSurferModalShell
    {
        BackdropId = "inventory-add-overlay",
        BackdropCssClass = "inventory-add-overlay wine-surfer-modal-backdrop",
        BackdropAttributes = new Dictionary<string, string?>
        {
            ["hidden"] = null,
            ["aria-hidden"] = "true"
        },
        DialogId = "inventory-add-popover",
        DialogCssClass = "inventory-add-popover wine-surfer-modal",
        DialogAttributes = new Dictionary<string, string?>
        {
            ["aria-labelledby"] = "inventory-add-title"
        },
        HeaderCssClass = "wine-surfer-modal__header inventory-add-header",
        Title = "Add Wine to Inventory",
        TitleCssClass = "wine-surfer-modal__title inventory-add-title",
        TitleElementId = "inventory-add-title",
        BodyCssClass = "wine-surfer-modal__body inventory-add-body",
        CloseButtonCssClass = "wine-surfer-modal__close inventory-add-close",
        CloseButtonLabel = "Close add wine dialog",
        CloseButtonAttributes = new Dictionary<string, string?>
        {
            ["data-add-wine-close"] = null
        },
        BodyContent = @<form class="inventory-add-form">
            <p class="inventory-add-intro">Choose an existing wine and vintage to add a bottle to your cellar.</p>
            <label class="inventory-add-field">
                <span class="inventory-add-label">Wine</span>
                <div class="inventory-add-combobox">
                    <input type="search"
                           class="inventory-add-wine-search"
                           placeholder="Search for a wine"
                           aria-label="Wine"
                           role="combobox"
                           aria-autocomplete="list"
                           aria-expanded="false"
                           aria-controls="inventory-add-wine-results"
                           autocomplete="off"
                           spellcheck="false" />
                    <input type="hidden" class="inventory-add-wine-id" />
                    <div class="inventory-add-wine-results" id="inventory-add-wine-results" role="listbox" aria-label="Matching wines"></div>
                </div>
            </label>
            <p class="inventory-add-summary" aria-live="polite">Search for a wine to see its appellation and color.</p>
            <label class="inventory-add-field">
                <span class="inventory-add-label">Vintage</span>
                <input type="number" class="inventory-add-vintage" min="1900" max="2100" placeholder="Year" aria-label="Vintage" />
            </label>
            <p class="inventory-add-vintage-hint" aria-live="polite">Search for a wine to view existing vintages.</p>
            <label class="inventory-add-field">
                <span class="inventory-add-label">Location</span>
                <select class="inventory-add-location" aria-label="Bottle location">
                    <option value="">No location</option>
                    @foreach (var option in locationOptions)
                    {
                        <option value="@option.Id">@BuildLocationLabel(option)</option>
                    }
                </select>
            </label>
            <label class="inventory-add-field">
                <span class="inventory-add-label">Number of Bottles</span>
                <select class="inventory-add-quantity" aria-label="Number of Bottles">
                    <option value="1" selected>1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                    <option value="6">6</option>
                    <option value="7">7</option>
                    <option value="8">8</option>
                    <option value="9">9</option>
                    <option value="10">10</option>
                    <option value="11">11</option>
                    <option value="12">12</option>
                </select>
            </label>
            <label class="inventory-add-field inventory-add-field--checkbox">
                <input type="checkbox" class="inventory-add-pending-delivery" />
                <span class="inventory-add-label">Pending delivery</span>
            </label>
            <p class="inventory-add-error" role="alert" aria-hidden="true"></p>
            <div class="inventory-add-actions">
                <button type="button" class="crud-table__action-button secondary inventory-add-cancel">Cancel</button>
                <button type="submit" class="crud-table__action-button inventory-add-submit">Add Wine</button>
            </div>
        </form>
    };

    var wineSurferModal = new WineSurferModalShell
    {
        BackdropId = "inventory-wine-surfer-overlay",
        BackdropCssClass = "inventory-add-overlay wine-surfer-modal-backdrop inventory-wine-surfer-overlay",
        BackdropAttributes = new Dictionary<string, string?>
        {
            ["hidden"] = null,
            ["aria-hidden"] = "true"
        },
        DialogId = "inventory-wine-surfer-popover",
        DialogCssClass = "inventory-add-popover wine-surfer-modal inventory-wine-surfer-popover",
        DialogAttributes = new Dictionary<string, string?>
        {
            ["aria-labelledby"] = "inventory-wine-surfer-title"
        },
        HeaderCssClass = "wine-surfer-modal__header inventory-wine-surfer-header",
        Title = "Wine Surfer suggestions",
        TitleCssClass = "wine-surfer-modal__title inventory-wine-surfer-title",
        TitleElementId = "inventory-wine-surfer-title",
        BodyCssClass = "wine-surfer-modal__body inventory-wine-surfer-body",
        CloseButtonCssClass = "wine-surfer-modal__close inventory-wine-surfer-close",
        CloseButtonLabel = "Close Wine Surfer suggestions dialog",
        CloseButtonAttributes = new Dictionary<string, string?>
        {
            ["data-wine-surfer-close"] = null
        },
        BodyContent = @<div class="inventory-wine-surfer-content">
            <p class="inventory-wine-surfer-intro" aria-live="polite">
                Wine Surfer searched for <span class="inventory-wine-surfer-query"></span>. Select a suggestion to add it to your cellar.
            </p>
            <div class="inventory-wine-surfer-status" aria-live="polite" role="status"></div>
            <ul class="inventory-wine-surfer-list" aria-label="Wine Surfer matches"></ul>
        </div>
    };

    var createWineModal = new WineSurferModalShell
    {
        BackdropId = "create-wine-overlay",
        BackdropCssClass = "inventory-add-overlay wine-surfer-modal-backdrop create-wine-overlay",
        BackdropAttributes = new Dictionary<string, string?>
        {
            ["hidden"] = null,
            ["aria-hidden"] = "true"
        },
        DialogId = "create-wine-popover",
        DialogCssClass = "inventory-add-popover wine-surfer-modal create-wine-popover",
        DialogAttributes = new Dictionary<string, string?>
        {
            ["aria-labelledby"] = "create-wine-title"
        },
        HeaderCssClass = "wine-surfer-modal__header create-wine-header",
        Title = "Create wine",
        TitleCssClass = "wine-surfer-modal__title create-wine-title",
        TitleElementId = "create-wine-title",
        BodyCssClass = "wine-surfer-modal__body create-wine-body",
        CloseButtonCssClass = "wine-surfer-modal__close create-wine-close",
        CloseButtonLabel = "Close create wine dialog",
        CloseButtonAttributes = new Dictionary<string, string?>
        {
            ["data-create-wine-close"] = null
        },
        BodyContent = @<form class="create-wine-form" novalidate>
            <p class="create-wine-intro">Enter the wine details to add it to your cellar.</p>
            <label class="inventory-add-field create-wine-field">
                <span class="inventory-add-label create-wine-label">Wine name</span>
                <input type="text"
                       class="create-wine-name"
                       placeholder="e.g. Penfolds Grange"
                       aria-label="Wine name"
                       maxlength="256"
                       required />
            </label>
            <label class="inventory-add-field create-wine-field">
                <span class="inventory-add-label create-wine-label">Color</span>
                <select class="create-wine-color" aria-label="Color" required>
                    <option value="Red">Red</option>
                    <option value="White">White</option>
                    <option value="Rose">Ros√©</option>
                </select>
            </label>
            <label class="inventory-add-field create-wine-field">
                <span class="inventory-add-label create-wine-label">Country</span>
                <div class="inventory-add-combobox create-wine-combobox" data-create-wine-combobox="country">
                    <input type="search"
                           class="create-wine-country-input"
                           placeholder="Search or create a country"
                           aria-label="Country"
                           role="combobox"
                           aria-autocomplete="list"
                           aria-expanded="false"
                           aria-controls="create-wine-country-results"
                           autocomplete="off"
                           spellcheck="false" />
                    <div class="inventory-add-wine-results create-wine-results"
                         id="create-wine-country-results"
                         role="listbox"
                         aria-label="Country suggestions"></div>
                </div>
            </label>
            <label class="inventory-add-field create-wine-field">
                <span class="inventory-add-label create-wine-label">Region</span>
                <div class="inventory-add-combobox create-wine-combobox" data-create-wine-combobox="region">
                    <input type="search"
                           class="create-wine-region-input"
                           placeholder="Search or create a region"
                           aria-label="Region"
                           role="combobox"
                           aria-autocomplete="list"
                           aria-expanded="false"
                           aria-controls="create-wine-region-results"
                           autocomplete="off"
                           spellcheck="false" />
                    <div class="inventory-add-wine-results create-wine-results"
                         id="create-wine-region-results"
                         role="listbox"
                         aria-label="Region suggestions"></div>
                </div>
            </label>
            <label class="inventory-add-field create-wine-field">
                <span class="inventory-add-label create-wine-label">Appellation</span>
                <div class="inventory-add-combobox create-wine-combobox" data-create-wine-combobox="appellation">
                    <input type="search"
                           class="create-wine-appellation-input"
                           placeholder="Search or create an appellation"
                           aria-label="Appellation"
                           role="combobox"
                           aria-autocomplete="list"
                           aria-expanded="false"
                           aria-controls="create-wine-appellation-results"
                           autocomplete="off"
                           spellcheck="false" />
                    <div class="inventory-add-wine-results create-wine-results"
                         id="create-wine-appellation-results"
                         role="listbox"
                         aria-label="Appellation suggestions"></div>
                </div>
            </label>
            <label class="inventory-add-field create-wine-field">
                <span class="inventory-add-label create-wine-label">Sub-appellation <span class="create-wine-optional">(optional)</span></span>
                <div class="inventory-add-combobox create-wine-combobox" data-create-wine-combobox="sub-appellation">
                    <input type="search"
                           class="create-wine-sub-appellation-input"
                           placeholder="Search or create a sub-appellation"
                           aria-label="Sub-appellation"
                           role="combobox"
                           aria-autocomplete="list"
                           aria-expanded="false"
                           aria-controls="create-wine-sub-appellation-results"
                           autocomplete="off"
                           spellcheck="false" />
                    <div class="inventory-add-wine-results create-wine-results"
                         id="create-wine-sub-appellation-results"
                         role="listbox"
                         aria-label="Sub-appellation suggestions"></div>
                </div>
            </label>
            <label class="inventory-add-field create-wine-field">
                <span class="inventory-add-label create-wine-label">Grape variety <span class="create-wine-optional">(optional)</span></span>
                <input type="text"
                       class="create-wine-grape"
                       placeholder="Optional"
                       aria-label="Grape variety"
                       maxlength="256" />
            </label>
            <p class="create-wine-error" role="alert" aria-hidden="true"></p>
            <div class="create-wine-actions">
                <button type="button" class="crud-table__action-button secondary create-wine-cancel">Cancel</button>
                <button type="submit" class="crud-table__action-button create-wine-submit">Create wine</button>
            </div>
        </form>
    };
}
@await Html.PartialAsync("_WineSurferModalShell", modal)
@await Html.PartialAsync("_WineSurferModalShell", wineSurferModal)
@await Html.PartialAsync("_WineSurferModalShell", createWineModal)
